<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>NSFW 关键词超市（AI Prompt 工作台）</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <style>
    * { margin:0; padding:0; box-sizing:border-box; }
    body { font-family: 'Segoe UI', sans-serif; background:#111; color:#eee; min-height:100vh; display:flex; flex-direction:column; }
    .header { padding:16px; background:#222; text-align:center; font-size:1.4em; font-weight:bold; }
    .controls { display:flex; gap:8px; padding:12px; background:#222; flex-wrap:wrap; justify-content:center; }
    button { padding:8px 16px; background:#007bff; color:white; border:none; border-radius:6px; cursor:pointer; font-size:0.9em; }
    button:hover { background:#0056b3; }

    .container { flex:1; display:flex; }
    .sidebar { width:260px; background:#1a1a1a; padding:12px; overflow-y:auto; }
    .folder { display:block; padding:8px; background:#333; border-radius:6px; cursor:pointer; margin:4px 0; }
    .folder:hover { background:#444; }
    .main { flex:1; padding:12px; display:flex; justify-content:center; }
    .grid { display:grid; grid-template-columns:repeat(auto-fill, minmax(240px, 1fr)); gap:12px; max-width:1200px; width:100%; }

    /* 购物车 - 居中 + 方形统一按钮 */
    .cart-wrapper {
      width: 100%;
      display: flex;
      justify-content: center;
      padding: 12px 0;
    }
    .cart-panel {
      background: #1a1a1a;
      border: 2px solid #f55; /* 红色边框 */
      border-radius: 12px;
      width: 100%;
      max-width: 800px;
      height: 140px;
      display: flex;
      padding: 12px;
      gap: 12px;
      font-size: 0.9em;
      margin: 0 16px;
    }

    /* 左侧：三个方形按钮 + 文本框 */
    .cart-left {
      flex: 1;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .cart-left-buttons {
      display: flex;
      gap: 8px;
    }
    .cart-left-buttons button,
    .cart-right button {
      width: 64px;
      height: 36px;
      padding: 0;
      border-radius: 6px;
      background: #444;
      color: #fff;
      font-size: 0.85em;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .cart-left-buttons button:hover,
    .cart-right button:hover { background: #666; }

    .cart-textarea {
      flex: 1;
      background: #222;
      border: 1px solid #555;
      border-radius: 8px;
      padding: 10px;
      color: #eee;
      font-family: inherit;
      font-size: 0.95em;
      resize: none;
      white-space: pre-wrap;
      word-break: break-all;
    }

    /* 右侧：三个方形垂直按钮 */
    .cart-right {
      width: 80px;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .cart-right button {
      background: #8b5cf6;
      color: white;
    }
    .cart-right button:hover { background: #7c3aed; }
  </style>
</head>
<body>

  <div class="header">NSFW 关键词超市（AI Prompt 工作台）</div>
  <div class="controls">
    <button onclick="UI.openAddModal()">新增关键词</button>
    <button onclick="Data.export()">导出 JSON</button>
    <input type="file" id="importFile" accept=".json" onchange="Data.import(event)" style="display:none;">
    <button onclick="document.getElementById('importFile').click()">导入 JSON</button>
    <button onclick="Data.sync()">同步到云端</button>
  </div>

  <div class="container">
    <nav class="sidebar">
      <div class="loading">云端加载中...</div>
      <ul id="navTree" style="display:none;"></ul>
    </nav>
    <section class="main">
      <div id="cardGrid" class="grid">
        <div style="grid-column:1/-1; text-align:center; color:#666; padding:40px;">
          请先选择左侧分类
        </div>
      </div>
    </section>
  </div>

  <!-- 居中购物车 -->
  <div class="cart-wrapper">
    <div class="cart-panel">
      <!-- 左侧 -->
      <div class="cart-left">
        <div class="cart-left-buttons">
          <button onclick="Cart.toggleHistory()">历史</button>
          <button onclick="Cart.clearHistory()">清空历史</button>
          <button onclick="Cart.openDraw()">抽词</button>
        </div>
        <textarea id="cartTextarea" class="cart-textarea" placeholder="购物车为空..." readonly></textarea>
      </div>
      <!-- 右侧 -->
      <div class="cart-right">
        <button onclick="Cart.copyAll()">复制全部</button>
        <button onclick="Cart.clear()">清空</button>
        <button onclick="Cart.saveToHistory()">保存历史</button>
      </div>
    </div>
  </div>

  <script>
    const Cart = {
      add(word) {
        if (!Storage.cart.includes(word)) {
          Storage.cart.push(word);
          Storage.saveCart();
          this.update();
        }
      },
      clear() { Storage.cart = []; Storage.saveCart(); this.update(); },
      copyAll() { 
        if (Storage.cart.length) {
          navigator.clipboard.writeText(Storage.cart.join(', '));
        }
      },
      update() {
        const ta = document.getElementById('cartTextarea');
        ta.value = Storage.cart.length ? Storage.cart.join(', ') : '';
      }
    };

    const Storage = {
      cart: JSON.parse(localStorage.getItem('cart') || '[]'),
      saveCart() { localStorage.setItem('cart', JSON.stringify(this.cart)); }
    };

    window.onload = () => Cart.update();
  </script>
</body>
</html>
